<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Form Kulit – Sunscreen</title>
<link rel="stylesheet" href="/assets/css/cssrecom.css">
</head>

<body>
<div class="page-wrapper">
<form id="skinForm">

<div class="title">
  Beri tahu kami tentang kulit Anda <br>
  Agar rekomendasi sunscreen lebih akurat
</div>

<div class="form-wrapper">

  <div class="form-group">
    <label>Umur</label>
    <input 
      type="number" 
      name="umur" 
      placeholder="Masukkan umur Anda"
      required
      min="1"
    >
  </div>

  <div class="form-group">
    <label>Jenis Kelamin</label>
    <select name="gender" required>
      <option value="">-- Pilih Jenis Kelamin --</option>
      <option value="laki-laki">Laki-laki</option>
      <option value="perempuan">Perempuan</option>
    </select>
  </div>

</div>

<div class="section-title">Hamil?</div>
<div class="option-row">
  <div></div>
  <div class="yn-buttons">
    <label><input type="radio" name="hamil" value="ya"> ya</label>
    <label><input type="radio" name="hamil" value="tidak" checked> tidak</label>
  </div>
</div>

<div class="section-title">Jenis Kulit & Kondisi</div>

<div class="option-row">
  <div>Berminyak</div>
  <div class="yn-buttons">
    <label><input type="radio" name="berminyak" value="ya"> ya</label>
    <label><input type="radio" name="berminyak" value="tidak" checked> tidak</label>
  </div>
</div>

<div class="option-row">
  <div>Kering</div>
  <div class="yn-buttons">
    <label><input type="radio" name="kering" value="ya"> ya</label>
    <label><input type="radio" name="kering" value="tidak" checked> tidak</label>
  </div>
</div>

<div class="option-row">
  <div>Kusam</div>
  <div class="yn-buttons">
    <label><input type="radio" name="kusam" value="ya"> ya</label>
    <label><input type="radio" name="kusam" value="tidak" checked> tidak</label>
  </div>
</div>

<div class="option-row">
  <div>Berjerawat</div>
  <div class="yn-buttons">
    <label><input type="radio" name="berjerawat" value="ya"> ya</label>
    <label><input type="radio" name="berjerawat" value="tidak" checked> tidak</label>
  </div>
</div>

<div class="option-row">
  <div>Kulit Sensitif</div>
  <div class="yn-buttons">
    <label><input type="radio" name="sensitif" value="ya"> ya</label>
    <label><input type="radio" name="sensitif" value="tidak" checked> tidak</label>
  </div>
</div>

<div class="option-row">
  <div>Beruntusan</div>
  <div class="yn-buttons">
    <label><input type="radio" name="beruntusan" value="ya"> ya</label>
    <label><input type="radio" name="beruntusan" value="tidak" checked> tidak</label>
  </div>
</div>

<div class="option-row">
  <div>Flek Hitam</div>
  <div class="yn-buttons">
    <label><input type="radio" name="flek" value="ya"> ya</label>
    <label><input type="radio" name="flek" value="tidak" checked> tidak</label>
  </div>
</div>

<div class="option-row">
  <div>Kemerahan</div>
  <div class="yn-buttons">
    <label><input type="radio" name="kemerahan" value="ya"> ya</label>
    <label><input type="radio" name="kemerahan" value="tidak" checked> tidak</label>
  </div>
</div>

<div class="option-row">
  <div>Pori-pori Besar</div>
  <div class="yn-buttons">
    <label><input type="radio" name="pori" value="ya"> ya</label>
    <label><input type="radio" name="pori" value="tidak" checked> tidak</label>
  </div>
</div>

<div class="option-row">
  <div>Berkomedo</div>
  <div class="yn-buttons">
    <label><input type="radio" name="komedo" value="ya"> ya</label>
    <label><input type="radio" name="komedo" value="tidak" checked> tidak</label>
  </div>
</div>

<button class="btn-send" type="button" onclick="kirim()">Kirim</button>
<br>
  <div class="bottom-nav">

    <div class="nav-item" data-page="index.html">
      <a href="/index.html">
        <img src="/assets/img/home.png" alt="Home">
      </a>
    </div>

    <div class="nav-item active" data-page="scanwajah.html">
      <a href="/scanwajah.html" class="search-icon">
        <img src="/assets/img/scanwajah.png" alt="Search">
      </a>
    </div>

    <div class="nav-item" data-page="favorite.html">
      <a href="/favorite.html">
        <img src="/assets/img/heart.png" alt="Favorite">
      </a>
    </div>

    <div class="nav-item" data-page="profile.html">
      <a href="/profile.html">
        <img src="/assets/img/user.png" alt="Profile">
      </a>
    </div>
  </div>
</form>
</div>

<!-- LOADING -->
<div id="loadingOverlay" class="loading-overlay">
  <div class="loading-box">
    <div class="spinner"></div>
    <p>AI sedang menganalisis kulit Anda…<br>Mohon tunggu sebentar</p>
  </div>
</div>

<script>
function kirim() {
  const form = document.getElementById("skinForm");

  const umur = form.querySelector('input[name="umur"]');
  const gender = form.querySelector('select[name="gender"]');

  if (!umur.value || Number(umur.value) <= 0) {
    alert("Umur wajib diisi");
    umur.focus();
    return;
  }

  if (!gender.value) {
    alert("Jenis kelamin wajib dipilih");
    gender.focus();
    return;
  }

  const data = Object.fromEntries(new FormData(form).entries());

  // =========================
  // ⬇️ AUTO CATEGORY (KUNCI)
  // =========================
  data.category = "sunscreen";

  document.getElementById("loadingOverlay").style.display = "flex";

  fetch("https://aang34.app.n8n.cloud/webhook/skinqu-input", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(res => res.json())
  .then(products => {
    sessionStorage.setItem("skinqu_products", JSON.stringify(products));
    window.location.href = "/product.html";
  })
  .catch(err => {
    document.getElementById("loadingOverlay").style.display = "none";
    alert("Gagal memproses rekomendasi");
    console.error(err);
  });
}
</script>

</body>
</html>
